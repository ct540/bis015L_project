---
title: "BIS015L Project"
authors: "Chloe, Emily, Ibrahim"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
    keep_md: yes
---

## Load Libraries 

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(janitor)
library(svglite)
library(shiny)
library(shinydashboard)
options(scipen=999)
``` 

## Load the Data
```{r}
disease <- readr::read_csv("Data/infectious-diseases-by-county-year-and-sex 2.csv")
disease
```

## Tidy Names of Data
```{r}
disease_tidy <- janitor::clean_names(disease)
names(disease_tidy)
```

## Remove data we will not use
```{r}
disease_data <- disease_tidy %>% 
  select(disease, county, year, sex, cases, population)
disease_data
```

## Summary of Data

```{r}
skimr::skim(disease_data)
```

```{r}
dim(disease_data)
```

```{r}
naniar::miss_var_summary(disease_data)
```

## Shiny App

```{r}
dat <- disease_data %>% filter(sex=="Total") %>% select(!sex)

ui <- dashboardPage(skin="purple",
  dashboardHeader(title = "Disease Abundance"),
  dashboardSidebar(disable = T),
  dashboardBody(
  fluidRow(
  box(title = "Plot Options", width = 3,
  selectInput("fill", "Select Disease", choices=unique(disease_data$disease)),
                hr(),
      helpText("The data represent cases with an estimated illness onset date from 2001 through the last year indicated from California Confidential Morbidity Reports and/or Laboratory Reports")
  ),
  
  box(title = "Disease Incidence Per California County", width = 9,
  plotOutput("plot", width = "1200px", height = "500px", click="plot_click"),
  verbatimTextOutput("info")
  ) 
  ) 
  )
  ) 

server <- function(input, output, session) { 
  
  output$plot <- renderPlot({
  disease_data %>% 
  filter(county!="California", disease==input$fill) %>% 
  ggplot(aes_string(x = "county", y="cases", fill="county")) + 
  geom_col()+
  theme_light(base_size = 18)+
  labs (x="County", y="Cases", fill="Disease")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position="none")
  })

  
   output$info <- renderText({
    paste0("x=", input$plot_click$x, "\ny=", input$plot_click$y)
})
  session$onSessionEnded(stopApp)
  
} 
shinyApp(ui, server)
```
